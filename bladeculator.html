<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="window">
    <div class="title-bar">
      <span>Калькулятор запаса лезвий v. 1.0</span>
      <div class="close-button">
        <img src="./images/close.svg" alt="close" width="11" height="11">
      </div>
    </div>
    <div class="content">
      <div class="header-container">
        <div class="razor-image">
          <img src="./images/blade.svg" alt="Blade" width="86" height="44" class="blade-icon" id="blade-icon">
        </div>
        <div style="display: none;">
          <img src="./images/blade-color.svg" alt="Preload Blade Color">
        </div>
        <h1>На сколько хватит моего запаса лезвий</h1>
      </div>
      
      <div class="input-group">
        <div class="input-label">Я бреюсь раз в</div>
        <div class="input-control">
          <div class="spinner-button" onclick="changeValue('days-input', -1)">
            <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
          </div>
          <div class="spinner">
            <input type="text" inputmode="numeric" inputmode="numeric" id="days-input" value="3">
          </div>
          <div class="spinner-button" onclick="changeValue('days-input', 1)">
            <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
          </div>
          <span class="unit-label" id="days-label">дней</span>
        </div>
      </div>
      
      <div class="input-group">
        <div class="input-label">Использую 1 лезвие</div>
        <div class="input-control">
          <div class="spinner-button" onclick="changeValue('uses-input', -1)">
            <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
          </div>
          <div class="spinner">
            <input type="text" inputmode="numeric" inputmode="numeric" id="uses-input" value="5">
          </div>
          <div class="spinner-button" onclick="changeValue('uses-input', 1)">
            <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
          </div>
          <span class="unit-label" id="uses-label">раз</span>
        </div>
      </div>
      
      <div class="razor-stock">
        <div class="razor-stock-title">Всего лезвий:</div>
        
        <div class="input-group stock-item">
          <div class="stock-label">Блоки</div>
          <div class="stock-size">100 шт. ×</div>
          <div class="input-control-stock">
            <div class="spinner-button" onclick="changeValue('pack100-input', -1)">
              <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
            </div>
            <div class="spinner">
              <input type="text" inputmode="numeric" id="pack100-input" value="0">
            </div>
            <div class="spinner-button" onclick="changeValue('pack100-input', 1)">
              <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
            </div>
          </div>
        </div>
        
        <div class="input-group stock-item">
          <div class="stock-label">Пачки</div>
          <div class="stock-size">10 шт. ×</div>
          <div class="input-control-stock">
            <div class="spinner-button" onclick="changeValue('pack10-input', -1)">
              <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
            </div>
            <div class="spinner">
              <input type="text" inputmode="numeric" id="pack10-input" value="1">
            </div>
            <div class="spinner-button" onclick="changeValue('pack10-input', 1)">
              <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
            </div>
          </div>
        </div>
        
        <div class="input-group stock-item">
          <div class="stock-label">Пачки</div>
          <div class="stock-size">5 шт. ×</div>
          <div class="input-control-stock">
            <div class="spinner-button" onclick="changeValue('pack5-input', -1)">
              <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
            </div>
            <div class="spinner">
              <input type="text" inputmode="numeric" id="pack5-input" value="0">
            </div>
            <div class="spinner-button" onclick="changeValue('pack5-input', 1)">
              <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
            </div>
          </div>
        </div>
        
        <div class="input-group stock-item">
          <div class="stock-label">Поштучно</div>
          <div class="stock-size">1 шт. ×</div>
          <div class="input-control-stock">
            <div class="spinner-button" onclick="changeValue('single-input', -1)">
              <img src="./images/left-arrow.svg" alt="Decrease" width="10" height="10">
            </div>
            <div class="spinner">
              <input type="text" inputmode="numeric" id="single-input" value="0">
            </div>
            <div class="spinner-button" onclick="changeValue('single-input', 1)">
              <img src="./images/right-arrow.svg" alt="Increase" width="10" height="10">
            </div>
          </div>
        </div>
      </div>
      
      <div class="results">
        <div class="result-title">%Number% лезвий хватит на:</div>
        <div class="result-text" id="result">3 месяца</div>
      </div>
    </div>
  </div>
<script>
const inputIds = ['days-input', 'uses-input', 'pack100-input', 'pack10-input', 'pack5-input', 'single-input'];
inputIds.forEach(inputId => {
  const input = document.getElementById(inputId);
  input.addEventListener('input', function() {
    this.value = this.value.replace(/[^0-9]/g, '');
    if ((inputId === 'days-input' || inputId === 'uses-input') && (this.value === '' || parseInt(this.value) < 1)) {
      this.value = '1';
    }
    updateLabels();
    calculateDuration();
  });
});

function changeValue(inputId, delta) {
  const input = document.getElementById(inputId);
  let value = parseInt(input.value) || 0;
  value = Math.max((inputId === 'days-input' || inputId === 'uses-input') ? 1 : 0, value + delta);
  input.value = value;
  updateLabels();
  calculateDuration();
}

function updateLabels() {
  const daysValue = parseInt(document.getElementById('days-input').value) || 0;
  const usesValue = parseInt(document.getElementById('uses-input').value) || 0;
  document.getElementById('days-label').textContent = pluralize(daysValue, 'день', 'дня', 'дней');
  document.getElementById('uses-label').textContent = pluralize(usesValue, 'раз', 'раза', 'раз');
}

function formatNumberWithNarrowSpace(number) {
  return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '&#8239;');
}

function calculateDuration() {
  const daysPerShave = parseInt(document.getElementById('days-input').value) || 1;
  const usesPerBlade = parseInt(document.getElementById('uses-input').value) || 1;
  const totalBlades = (parseInt(document.getElementById('pack100-input').value) || 0) * 100 +
                     (parseInt(document.getElementById('pack10-input').value) || 0) * 10 +
                     (parseInt(document.getElementById('pack5-input').value) || 0) * 5 +
                     (parseInt(document.getElementById('single-input').value) || 0);

  const resultTitle = document.querySelector('.result-title');
  resultTitle.innerHTML = `${formatNumberWithNarrowSpace(totalBlades)} ${pluralizeBlade(totalBlades)} хватит на:`; // Используем innerHTML
  
  if (totalBlades === 0) {
    document.getElementById('result').innerHTML = '0&nbsp;дней';
    return;
  }
  const totalDays = totalBlades * usesPerBlade * daysPerShave;
  document.getElementById('result').innerHTML = formatDuration(totalDays);
}

function formatDuration(days) {
  if (days <= 0) return '0&nbsp;дней';
  const years = Math.floor(days / 365);
  days -= years * 365;
  const months = Math.floor(days / 30);
  days -= months * 30;
  let result = '';
  if (years > 0) result += `${formatNumberWithNarrowSpace(years)}&nbsp;${pluralize(years, 'год', 'года', 'лет')} `;
  if (months > 0) result += `${formatNumberWithNarrowSpace(months)}&nbsp;${pluralize(months, 'месяц', 'месяца', 'месяцев')} `;
  if (days > 0 || (years === 0 && months === 0)) result += `${formatNumberWithNarrowSpace(days)}&nbsp;${pluralize(days, 'день', 'дня', 'дней')}`;
  return result.trim();
}

function pluralizeBlade(number) {
  const mod10 = number % 10;
  const mod100 = number % 100;
  if (mod100 >= 11 && mod100 <= 19) return 'лезвий';
  if (mod10 === 1) return 'лезвие';
  if (mod10 >= 2 && mod10 <= 4) return 'лезвия';
  return 'лезвий';
}

function pluralize(number, one, few, many) {
  const mod10 = number % 10;
  const mod100 = number % 100;
  if (mod100 >= 11 && mod100 <= 19) return many;
  if (mod10 === 1) return one;
  if (mod10 >= 2 && mod10 <= 4) return few;
  return many;
}

updateLabels();
calculateDuration();

document.addEventListener('DOMContentLoaded', function() {
  const textInputs = document.querySelectorAll('input[type="text"]');
  
  textInputs.forEach(input => {
    input.addEventListener('focus', function() {
      setTimeout(() => this.select(), 10);
    });
    
    input.addEventListener('click', function() {
      setTimeout(() => this.select(), 10);
    });
    
    input.addEventListener('touchstart', function() {
      setTimeout(() => this.select(), 10);
    });
  });
});

document.addEventListener('DOMContentLoaded', function() {
  const bladeIcon = document.getElementById('blade-icon');
  let isColorMode = false;

  bladeIcon.addEventListener('click', function() {
    if (isColorMode) {
      bladeIcon.src = './images/blade.svg';
    } else {
      bladeIcon.src = './images/blade-color.svg';
    }
    isColorMode = !isColorMode;
  });
});
</script>

</body>
</html>